<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Telegram –ë–æ—Ç—ã | –ü–∞–≤–µ–ª –®—É–º–∫–æ–≤</title>
    <link rel="stylesheet" href="../style.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Space+Mono&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
<nav>
    <div class="logo">Mayzic.<span>DEV</span></div>
    <ul class="nav-links">
        <li><a href="../index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
        <li><a href="../about.html">–û–±–æ –º–Ω–µ</a></li>
        <li><a href="index.html" class="active">–ü–æ—Ä—Ç—Ñ–æ–ª–∏–æ</a></li>
        <li><a href="../contact.html">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
    </ul>
</nav>

<section id="project-detail">
    <div class="project-detail-header">
        <span class="category-badge">Telegram Bot ‚Ä¢ Python ‚Ä¢ aiogram</span>
        <h3>Telegram –ë–æ—Ç—ã</h3>
        <p>–ü–æ–ª–µ–∑–Ω—ã–µ –±–æ—Ç—ã —Å —Ä–∞–∑–ª–∏—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é –Ω–∞ Python + aiogram</p>
    </div>

    <div class="project-detail-content">
        <!-- –ë–æ—Ç-–Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞ -->
        <div id="reminder" class="code-section">
            <div class="code-section-header">
                <i class="fas fa-bell"></i>
                <h5>–ë–æ—Ç-–ù–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞</h5>
            </div>

            <div class="code-explanation">
                <h6>–û –ø—Ä–æ–µ–∫—Ç–µ:</h6>
                <p>Telegram –±–æ—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ –º–∏–Ω—É—Ç—ã. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±—ã—Å—Ç—Ä—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è (—á–µ—Ä–µ–∑ 5/15/30 –º–∏–Ω—É—Ç) –∏ –æ–±—ã—á–Ω—ã–µ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏.</p>

                <h6>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</h6>
                <ul>
                    <li>‚úÖ FSM (Finite State Machine) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞–º–∏</li>
                    <li>‚úÖ SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π</li>
                    <li>‚úÖ –§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π</li>
                    <li>‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–∞ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏</li>
                    <li>‚úÖ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –¥–µ–ø–ª–æ—è</li>
                    <li>‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫</li>
                </ul>
            </div>

            <div class="bot-features-grid">
                <div class="bot-feature">
                    <i class="fas fa-database"></i>
                    <h6>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö</h6>
                    <p>SQLite —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ users –∏ reminders</p>
                </div>
                <div class="bot-feature">
                    <i class="fas fa-tasks"></i>
                    <h6>–§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞</h6>
                    <p>Asyncio task –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π</p>
                </div>
                <div class="bot-feature">
                    <i class="fas fa-calendar-check"></i>
                    <h6>–ì–∏–±–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</h6>
                    <p>–ë—ã—Å—Ç—Ä—ã–µ –∏ —Ç–æ—á–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è</p>
                </div>
                <div class="bot-feature">
                    <i class="fas fa-code"></i>
                    <h6>–ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</h6>
                    <p>–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏, –ë–î –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤</p>
                </div>
            </div>

            <div class="code-block-container">
                <h4 class="code-title">main.py - –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞</h4>
                <pre><code class="language-python">
import asyncio
import logging
import sqlite3
from datetime import datetime, timedelta
from aiogram import Bot, Dispatcher, types
from aiogram.filters import Command
from aiogram.fsm.context import FSMContext
from aiogram.fsm.state import State, StatesGroup
from aiogram.fsm.storage.memory import MemoryStorage

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO)

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
API_TOKEN = 'YOUR_BOT_TOKEN'
bot = Bot(token=API_TOKEN)
dp = Dispatcher(storage=MemoryStorage())

# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
class ReminderStates(StatesGroup):
    waiting_for_text = State()
    waiting_for_date = State()
    waiting_for_time = State()

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
def init_db():
    conn = sqlite3.connect('reminders.db')
    cursor = conn.cursor()

    cursor.execute('''
        CREATE TABLE IF NOT EXISTS users (
            id INTEGER PRIMARY KEY,
            username TEXT,
            first_name TEXT,
            join_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP
        )
    ''')

    cursor.execute('''
        CREATE TABLE IF NOT EXISTS reminders (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            user_id INTEGER NOT NULL,
            text TEXT NOT NULL,
            remind_datetime TIMESTAMP NOT NULL,
            status TEXT DEFAULT 'pending',
            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
            FOREIGN KEY (user_id) REFERENCES users (id)
        )
    ''')

    conn.commit()
    conn.close()

# –§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
async def check_reminders():
    while True:
        try:
            conn = sqlite3.connect('reminders.db')
            cursor = conn.cursor()

            # –ü–æ–ª—É—á–∞–µ–º –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è, –≤—Ä–µ–º—è –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—Å—Ç—É–ø–∏–ª–æ
            now = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
            cursor.execute(
                "SELECT id, user_id, text FROM reminders WHERE remind_datetime <= ? AND status = 'pending'",
                (now,)
            )

            reminders = cursor.fetchall()

            for reminder_id, user_id, text in reminders:
                try:
                    await bot.send_message(
                        user_id,
                        f"‚è∞ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ!\n\n{text}\n\n–ù–∞–¥–µ—é—Å—å, –≤—ã –Ω–µ –∑–∞–±—ã–ª–∏! ‚úÖ"
                    )

                    # –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ
                    cursor.execute(
                        "UPDATE reminders SET status = 'sent' WHERE id = ?",
                        (reminder_id,)
                    )

                    await asyncio.sleep(1)

                except Exception as e:
                    logging.error(f"–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è {reminder_id}: {e}")

            conn.commit()
            conn.close()

        except Exception as e:
            logging.error(f"–û—à–∏–±–∫–∞ –≤ —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–¥–∞—á–µ: {e}")

        await asyncio.sleep(10)  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥

# –ö–æ–º–∞–Ω–¥–∞ /start
@dp.message(Command("start"))
async def cmd_start(message: types.Message):
    user = message.from_user

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    conn = sqlite3.connect('reminders.db')
    cursor = conn.cursor()
    cursor.execute(
        "INSERT OR IGNORE INTO users (id, username, first_name) VALUES (?, ?, ?)",
        (user.id, user.username, user.first_name)
    )
    conn.commit()
    conn.close()

    await message.answer(
        f"üëã –ü—Ä–∏–≤–µ—Ç, {user.first_name}!\n\n"
        "–Ø –±–æ—Ç-–Ω–∞–ø–æ–º–∏–Ω–∞–ª–∫–∞! –ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—ã:\n"
        "/remind - —Å–æ–∑–¥–∞—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ\n"
        "/list - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–≤–æ–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è\n"
        "/help - —Å–ø—Ä–∞–≤–∫–∞"
    )

# –ö–æ–º–∞–Ω–¥–∞ /remind
@dp.message(Command("remind"))
async def cmd_remind(message: types.Message, state: FSMContext):
    await message.answer(
        "üìù –í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è:\n\n"
        "–ù–∞–ø—Ä–∏–º–µ—Ä: ¬´–ü–æ–∑–≤–æ–Ω–∏—Ç—å –º–∞–º–µ¬ª –∏–ª–∏ ¬´–°–¥–∞—Ç—å –æ—Ç—á–µ—Ç¬ª"
    )
    await state.set_state(ReminderStates.waiting_for_text)

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ç–µ–∫—Å—Ç–∞ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
@dp.message(ReminderStates.waiting_for_text)
async def process_text(message: types.Message, state: FSMContext):
    await state.update_data(text=message.text)
    await message.answer(
        "üìÖ –í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É –≤ —Ñ–æ—Ä–º–∞—Ç–µ –î–î.–ú–ú.–ì–ì–ì–ì:\n\n"
        "–ù–∞–ø—Ä–∏–º–µ—Ä: 25.12.2024\n"
        "–ò–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ '—Å–µ–≥–æ–¥–Ω—è', '–∑–∞–≤—Ç—Ä–∞'"
    )
    await state.set_state(ReminderStates.waiting_for_date)

# –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
async def main():
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
    init_db()

    # –ó–∞–ø—É—Å–∫ —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏
    asyncio.create_task(check_reminders())

    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())
                    </code></pre>
            </div>

            <div class="code-block-container">
                <h4 class="code-title">Dockerfile - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞</h4>
                <pre><code class="language-dockerfile">
FROM python:3.10-slim

WORKDIR /app

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞
COPY . .

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
RUN useradd -m -u 1000 botuser && chown -R botuser:botuser /app
USER botuser

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
CMD ["python", "main.py"]
                    </code></pre>
            </div>

            <div class="code-block-container">
                <h4 class="code-title">requirements.txt - –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞</h4>
                <pre><code>
aiogram==3.0.0b7
python-dotenv==1.0.0
APScheduler==3.10.1
                    </code></pre>
            </div>
        </div>

        <hr style="margin: 60px 0; border: 1px solid rgba(255,255,255,0.1);">

        <!-- –ë–æ—Ç –¥–ª—è —Ñ–∏–∑–∏–∫–∏ -->
        <div id="physics" class="code-section">
            <div class="code-section-header">
                <i class="fas fa-atom"></i>
                <h5>Physics Prep Bot</h5>
            </div>

            <div class="code-explanation">
                <h6>–û –ø—Ä–æ–µ–∫—Ç–µ:</h6>
                <p>–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π Telegram –±–æ—Ç –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∫ —ç–∫–∑–∞–º–µ–Ω–∞–º –ø–æ —Ñ–∏–∑–∏–∫–µ. –°–æ–¥–µ—Ä–∂–∏—Ç –±–∞–∑—É –∏–∑ 84 –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ —Ä–∞–∑–Ω—ã–º —Ç–µ–º–∞–º –º–µ—Ö–∞–Ω–∏–∫–∏, –¥–∏–Ω–∞–º–∏–∫–∏, –∫–æ–ª–µ–±–∞–Ω–∏–π –∏ –≤–æ–ª–Ω.</p>

                <h6>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</h6>
                <ul>
                    <li>üéØ –ß–µ–ª–ª–µ–Ω–¥–∂-—Ä–µ–∂–∏–º: –æ–¥–Ω–∞ –æ—à–∏–±–∫–∞ ‚Äî —Ç–µ—Å—Ç –æ–±–Ω—É–ª—è–µ—Ç—Å—è</li>
                    <li>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</li>
                    <li>üîÑ –†–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—è–¥–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤</li>
                    <li>üìù –ü–æ–¥—Ä–æ–±–Ω—ã–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</li>
                    <li>üèÜ –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç (—Ä–µ–∫–æ—Ä–¥ –ø–æ–¥—Ä—è–¥ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤)</li>
                    <li>üé≤ –í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –¥–ª–∏–Ω—ã (–Ω–µ–ª—å–∑—è —É–≥–∞–¥–∞—Ç—å –ø–æ –¥–ª–∏–Ω–µ)</li>
                </ul>
            </div>

            <div class="code-block-container">
                <h4 class="code-title">physics_bot.py - –û—Å–Ω–æ–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞</h4>
                <pre><code class="language-python">
import asyncio
import logging
import random
import json
from aiogram import Bot, Dispatcher, types
from aiogram.filters import Command
from aiogram.fsm.context import FSMContext
from aiogram.fsm.state import State, StatesGroup
from aiogram.fsm.storage.memory import MemoryStorage
from aiogram.types import ReplyKeyboardMarkup, KeyboardButton

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(level=logging.INFO)

# –ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏–∑ JSON
with open('physics_questions.json', 'r', encoding='utf-8') as f:
    QUESTIONS = json.load(f)

# –°–æ—Å—Ç–æ—è–Ω–∏—è FSM
class PhysicsStates(StatesGroup):
    in_challenge = State()
    waiting_answer = State()

# –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–µ—Å—Å–∏–π
user_sessions = {}
user_current_tests = {}

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ –æ—Ç–≤–µ—Ç–æ–≤
def get_answer_keyboard():
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="1"), KeyboardButton(text="2")],
            [KeyboardButton(text="3"), KeyboardButton(text="4")]
        ],
        resize_keyboard=True
    )

def get_main_keyboard():
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="üéØ –ù–∞—á–∞—Ç—å —á–µ–ª–ª–µ–Ω–¥–∂")],
            [KeyboardButton(text="üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"), KeyboardButton(text="‚ùì –ü–æ–º–æ—â—å")]
        ],
        resize_keyboard=True
    )

# –ö–æ–º–∞–Ω–¥–∞ /start
@dp.message(Command("start"))
async def cmd_start(message: types.Message):
    user_id = message.from_user.id

    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if user_id not in user_sessions:
        user_sessions[user_id] = {
            "total_tests": 0,
            "total_correct": 0,
            "total_questions": 0,
            "best_streak": 0,
            "completed_tests": []
        }

    await message.answer(
        "üî• <b>–§–ò–ó–ò–ß–ï–°–ö–ò–ô –ß–ï–õ–õ–ï–ù–î–ñ</b>\n\n"
        "<b>–ü—Ä–∞–≤–∏–ª–∞:</b>\n"
        "1. ‚ùå <b>–û–¥–Ω–∞ –æ—à–∏–±–∫–∞ - –∏ —Ç–µ—Å—Ç –æ–±–Ω—É–ª—è–µ—Ç—Å—è!</b>\n"
        "2. üîÑ <b>–í–æ–ø—Ä–æ—Å—ã –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è –≤ —Ç–µ—Å—Ç–µ</b>\n"
        "3. üéØ <b>–¶–µ–ª—å: –ø—Ä–æ–π—Ç–∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥</b>\n\n"
        "–í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤ –≤ –±–∞–∑–µ: 84\n"
        "<b>–ì–æ—Ç–æ–≤ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è? –ù–∞–∂–∏–º–∞–π üéØ –ù–∞—á–∞—Ç—å —á–µ–ª–ª–µ–Ω–¥–∂!</b>",
        reply_markup=get_main_keyboard(),
        parse_mode="HTML"
    )

# –ó–∞–ø—É—Å–∫ —á–µ–ª–ª–µ–Ω–¥–∂–∞
@dp.message(lambda message: message.text == "üéØ –ù–∞—á–∞—Ç—å —á–µ–ª–ª–µ–Ω–¥–∂")
async def start_challenge(message: types.Message, state: FSMContext):
    user_id = message.from_user.id

    # –°–æ–∑–¥–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤
    all_questions = list(QUESTIONS.keys())
    random.shuffle(all_questions)

    user_current_tests[user_id] = {
        "question_order": all_questions,
        "current_index": 0,
        "correct_in_test": 0,
        "questions_asked": set()
    }

    user_sessions[user_id]["total_tests"] += 1

    await message.answer(
        "üî• <b>–ß–µ–ª–ª–µ–Ω–¥–∂ –Ω–∞—á–∞–ª—Å—è!</b>\n\n"
        "‚ùå <b>–û–¥–Ω–∞ –æ—à–∏–±–∫–∞ - –∏ –≤—Å–µ –æ–±–Ω—É–ª—è–µ—Ç—Å—è!</b>\n"
        "üéØ <b>–¶–µ–ª—å: –ø—Ä–æ–π—Ç–∏ –∫–∞–∫ –º–æ–∂–Ω–æ –±–æ–ª—å—à–µ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥</b>\n\n"
        "<i>–£–¥–∞—á–∏! –ü–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å:</i>",
        reply_markup=get_answer_keyboard(),
        parse_mode="HTML"
    )

    await ask_question(user_id, message.chat.id)
    await state.set_state(PhysicsStates.waiting_answer)

# –§—É–Ω–∫—Ü–∏—è –∑–∞–¥–∞–≤–∞–Ω–∏—è –≤–æ–ø—Ä–æ—Å–∞
async def ask_question(user_id, chat_id):
    current_test = user_current_tests.get(user_id)
    if not current_test:
        return

    question_id = current_test["question_order"][current_test["current_index"]]
    question_data = QUESTIONS[question_id]

    # –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
    all_answers = [question_data["correct"]] + question_data["wrong"]
    random.shuffle(all_answers)

    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
    correct_position = all_answers.index(question_data["correct"]) + 1
    current_test["correct_answer"] = correct_position
    current_test["current_question"] = question_data

    # –§–æ—Ä–º–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞
    question_text = (
        f"<i>–í–æ–ø—Ä–æ—Å {current_test['current_index'] + 1}:</i>\n\n"
        f"<b>{question_data['text']}</b>\n\n"
        f"–í–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–∞:\n"
        f"<b>1.</b> {all_answers[0]}\n"
        f"<b>2.</b> {all_answers[1]}\n"
        f"<b>3.</b> {all_answers[2]}\n"
        f"<b>4.</b> {all_answers[3]}"
    )

    await bot.send_message(
        chat_id,
        question_text,
        reply_markup=get_answer_keyboard(),
        parse_mode="HTML"
    )

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–≤–µ—Ç–æ–≤
@dp.message(PhysicsStates.waiting_answer)
async def handle_answer(message: types.Message, state: FSMContext):
    user_id = message.from_user.id
    current_test = user_current_tests.get(user_id)

    if not current_test:
        return

    user_answer = message.text
    if user_answer not in ["1", "2", "3", "4"]:
        await message.answer("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 1, 2, 3 –∏–ª–∏ 4")
        return

    user_answer_num = int(user_answer)
    correct_answer = current_test["correct_answer"]

    if user_answer_num == correct_answer:
        # –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
        current_test["correct_in_test"] += 1
        current_test["current_index"] += 1

        # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        user_sessions[user_id]["total_correct"] += 1
        user_sessions[user_id]["total_questions"] += 1

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –ª–∏ –≤–æ–ø—Ä–æ—Å—ã
        if current_test["current_index"] >= len(current_test["question_order"]):
            # –ü–æ–±–µ–¥–∞!
            final_streak = current_test["correct_in_test"]
            if final_streak > user_sessions[user_id]["best_streak"]:
                user_sessions[user_id]["best_streak"] = final_streak

            await message.answer(
                f"üéâ <b>–ü–û–ë–ï–î–ê!</b> –í—ã –ø—Ä–æ—à–ª–∏ –≤—Å–µ {final_streak} –≤–æ–ø—Ä–æ—Å–æ–≤ –±–µ–∑ –æ—à–∏–±–æ–∫!\n\n"
                f"–í–∞—à –Ω–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥: <b>{final_streak}</b> –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥!",
                reply_markup=get_main_keyboard(),
                parse_mode="HTML"
            )
            await state.clear()
        else:
            await message.answer("‚úÖ <b>–í–µ—Ä–Ω–æ!</b> –°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å:", parse_mode="HTML")
            await ask_question(user_id, message.chat.id)
    else:
        # –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
        final_streak = current_test["correct_in_test"]
        user_sessions[user_id]["total_questions"] += 1

        correct_text = current_test["current_question"]["correct"]

        await message.answer(
            f"‚ùå <b>–û–®–ò–ë–ö–ê!</b>\n\n"
            f"–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞ <b>{final_streak}</b> –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥.\n\n"
            f"–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: <b>{correct_text}</b>\n\n"
            f"–í–∞—à –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: <b>{user_sessions[user_id]['best_streak']}</b>",
            reply_markup=get_main_keyboard(),
            parse_mode="HTML"
        )
        await state.clear()

# –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
async def main():
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())
                    </code></pre>
            </div>

            <div class="code-block-container">
                <h4 class="code-title">–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã questions.json</h4>
                <pre><code class="language-json">
{
    "1": {
        "text": "–û—Ç —á–µ–≥–æ –∑–∞–≤–∏—Å–∏—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ (—Ü–µ–Ω—Ç—Ä–æ—Å—Ç—Ä–µ–º–∏—Ç–µ–ª—å–Ω–æ–µ) —É—Å–∫–æ—Ä–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–∏?",
        "correct": "–ó–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–µ–ª–∏—á–∏–Ω—ã —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ —Ä–∞–¥–∏—É—Å–∞ –∫—Ä–∏–≤–∏–∑–Ω—ã —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏.",
        "wrong": [
            "–ó–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç –≤–µ–ª–∏—á–∏–Ω—ã —Å–∫–æ—Ä–æ—Å—Ç–∏ –¥–≤–∏–∂–µ–Ω–∏—è —Ç–æ—á–∫–∏.",
            "–ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∞–Ω–≥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è –∏ —É–≥–ª–æ–≤–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏.",
            "–ó–∞–≤–∏—Å–∏—Ç –æ—Ç —É–≥–ª–æ–≤–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏ –¥–≤–∏–∂–µ–Ω–∏—è."
        ]
    },
    "2": {
        "text": "–ß—Ç–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç —Ç–∞–Ω–≥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ (–∫–∞—Å–∞—Ç–µ–ª—å–Ω–æ–µ) —É—Å–∫–æ—Ä–µ–Ω–∏–µ?",
        "correct": "–•–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ –≤–µ–ª–∏—á–∏–Ω–µ.",
        "wrong": [
            "–•–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é.",
            "–•–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–¥–∏—É—Å–∞ –∫—Ä–∏–≤–∏–∑–Ω—ã —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏.",
            "–•–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ —É–≥–ª–æ–≤–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –≤—Ä–∞—â–µ–Ω–∏—è."
        ]
    },
    "3": {
        "text": "–ü–æ –∫–∞–∫–æ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –¥–≤–∏–∂–µ—Ç—Å—è —á–∞—Å—Ç–∏—Ü–∞, –µ—Å–ª–∏ —Ç–∞–Ω–≥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ, –∞ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ –Ω—É–ª—é?",
        "correct": "–ü–æ –ø—Ä—è–º–æ–π –ª–∏–Ω–∏–∏.",
        "wrong": [
            "–ü–æ –æ–∫—Ä—É–∂–Ω–æ—Å—Ç–∏ —Å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é.",
            "–ü–æ –ø–∞—Ä–∞–±–æ–ª–∏—á–µ—Å–∫–æ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏.",
            "–ü–æ —Å–ø–∏—Ä–∞–ª–∏ —Å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º —à–∞–≥–æ–º."
        ]
    }
}
                    </code></pre>
            </div>

            <div class="tech-stack-grid">
                <div class="tech-item">Python 3.10</div>
                <div class="tech-item">aiogram 3.x</div>
                <div class="tech-item">JSON</div>
                <div class="tech-item">FSM</div>
                <div class="tech-item">Random</div>
                <div class="tech-item">asyncio</div>
            </div>
        </div>
    </div>

    <div style="text-align: center; margin: 50px 0;">
        <a href="index.html#telegram" class="back-to-categories">
            <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥ –∫ Telegram –±–æ—Ç–∞–º
        </a>
        <a href="index.html" class="btn secondary" style="margin-left: 20px;">
            <i class="fas fa-th"></i> –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤
        </a>
    </div>
</section>

<footer>
    <div class="footer-content">
        <p>–¢–µ–ª–µ—Ñ–æ–Ω: <a href="tel:+79222572429">+7 (922) 257-24-29</a></p>
        <p>Email: <a href="mailto:shumkov.pasha@list.ru">shumkov.pasha@list.ru</a></p>
        <div class="social-icons">
            <a href="https://github.com/Mayzic" target="_blank"><i class="fab fa-github fa-2x"></i></a>
            <a href="https://t.me/Hippo_lilka" target="_blank"><i class="fab fa-telegram fa-2x"></i></a>
        </div>
        <p class="copyright">¬© 2025 –®—É–º–∫–æ–≤ –ü–∞–≤–µ–ª. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    </div>
</footer>

<script src="../script.js"></script>
</body>
</html>
